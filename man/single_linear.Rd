% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/linears.R
\name{single_linear}
\alias{single_linear}
\title{Perform single metabolite linear regression analysis with comprehensive evaluation}
\usage{
single_linear(data, NC, Treatment, save_dir = "./")
}
\arguments{
\item{data}{A data frame containing the metabolomics data. The first column should be 
the class labels (as factor), and subsequent columns represent metabolite concentrations.}

\item{NC}{Character string specifying the name of the negative control/normal group 
in the class column (e.g., "Control" or "Normal").}

\item{Treatment}{Character string specifying the name of the treatment group 
in the class column (e.g., "Case" or "Disease").}
}
\value{
A data frame with one row per metabolite containing the following columns:
\itemize{
  \item Metabolite: Character, name of the metabolite
  \item Model_Equation: Character, linear regression equation
  \item R2: Numeric, R-squared value of the linear model
  \item AUC: Numeric, area under the ROC curve
  \item Accuracy: Numeric, classification accuracy at optimal threshold
  \item FPR: Numeric, false positive rate
  \item Sensitivity: Numeric, true positive rate
  \item Specificity: Numeric, true negative rate
  \item F1score: Numeric, F1 score (harmonic mean of precision and sensitivity)
  \item log2FC: Numeric, log2 fold change between treatment and control groups
  \item pvalue: Numeric, p-value from t-test between groups
}
}
\description{
This function conducts linear regression analysis for each metabolite in the dataset,
evaluating the relationship between metabolite concentration and treatment classification.
It generates comprehensive performance metrics, ROC curves, and visualization plots.
}
\details{
This function performs the following analysis for each metabolite:
\enumerate{
  \item Fits a linear regression model: class ~ metabolite concentration
  \item Calculates ROC curve and AUC using predictions from the linear model
  \item Determines optimal classification threshold maximizing accuracy
  \item Computes comprehensive performance metrics (accuracy, sensitivity, specificity, F1)
  \item Calculates log2 fold change and statistical significance between groups
  \item Generates individual ROC plots and grouped bar plots with statistical annotations
  \item Saves top 10 metabolites by AUC in a combined ROC plot
}

The function creates two directories: "Individual_ROCs" for ROC curves and 
"Barplots" for concentration comparison plots. It also exports an Excel file 
with complete results and displays top performers in the console.
}
\examples{
\dontrun{
# Load example metabolomics data
data <- read.csv("metabolite_data.csv")

# Ensure class column is factor
data$class <- as.factor(data$class)

# Run analysis comparing "Control" vs "Treatment" groups
results <- single_linear(data, NC = "Control", Treatment = "Treatment")

# View top 10 metabolites by AUC
head(results, 10)
}

}
\seealso{
Useful links:
\itemize{
  \item \code{\link[stats]{lm}} for linear regression
  \item \code{\link[pROC]{roc}} for ROC curve calculation
  \item \code{\link[ggplot2]{ggplot}} for visualization
}
}
